<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Author Profile - Blog</title>
    <meta name="robots" content="index, follow" />
    <link type="text/css" rel="stylesheet" href="css/plugins.css">
    <link type="text/css" rel="stylesheet" href="css/style.css">
    <link type="text/css" rel="stylesheet" href="css/color.css">
    <link rel="shortcut icon" href="images/favicon.ico">
</head>
<body>
    <div id="main">
        <header class="main-header">
            <div class="top-bar fl-wrap">
                <div class="container">
                    <div class="date-holder">
                        <span class="date_num"></span>
                        <span class="date_mounth"></span>
                        <span class="date_year"></span>
                    </div>
                </div>
            </div>
            <div class="header-inner fl-wrap">
                <div class="container">
                    <div class="logo-holder">
                        <a href="index.html"><img src="images/logo.png" alt=""></a>
                    </div>
                    <div class="nav-button-wrap">
                        <div class="nav-button"><span></span><span></span><span></span></div>
                    </div>
                    <div class="nav-holder">
                        <nav class="main-nav">
                            <ul id="categories-list">
                                <li><a href="index.html">Home</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </header>

        <div class="content">
            <section class="section">
                <div class="container">
                    <div class="row">
                        <div class="col-md-8">
                            <div id="author-profile">
                                <div class="ajax-loader">
                                    <div class="spinner"></div>
                                </div>
                            </div>
                            <div id="author-articles" class="mt-6">
                                <!-- Articles will be loaded here -->
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="sidebar">
                                <div class="box-widget fl-wrap">
                                    <div class="widget-title">Author Stats</div>
                                    <div class="box-widget-content" id="author-stats">
                                        <!-- Stats will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <footer class="fl-wrap main-footer">
            <div class="container">
                <div class="footer-bottom fl-wrap">
                    <div class="copyright"><span>&#169; Blog 2025</span> . All rights reserved.</div>
                </div>
            </div>
        </footer>
    </div>

    <script src="js/jquery.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/scripts.js"></script>
    <script>
        const API_URL = 'http://localhost:3000/api';
        
        async function loadAuthorProfile() {
            const urlParams = new URLSearchParams(window.location.search);
            const slug = urlParams.get('slug');
            
            if (!slug) {
                document.getElementById('author-profile').innerHTML = '<p>Author not found</p>';
                return;
            }
            
            try {
                const response = await fetch(`${API_URL}/authors/${slug}`);
                const json = await response.json();
                
                if (!json.success || !json.data) {
                    throw new Error('Author not found');
                }
                
                const author = json.data;
                
                // Render author profile
                const profileHTML = `
                    <div class="author-profile-header" style="padding: 40px; background: white; border-radius: 12px; margin-bottom: 30px;">
                        <div class="flex items-center gap-6">
                            <div class="author-avatar" style="width: 120px; height: 120px; border-radius: 50%; overflow: hidden; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 48px; font-weight: bold;">
                            ${author.avatar_url ? `<img src="${author.avatar_url}" alt="${author.name}" style="width: 100%; height: 100%; object-fit: cover;">` : author.name.charAt(0).toUpperCase()}
                            </div>
                            <div class="flex-1">
                                <h1 style="font-size: 32px; font-weight: bold; margin-bottom: 10px;">${author.name}</h1>
                                ${author.bio ? `<p style="color: #666; margin-bottom: 15px; line-height: 1.6;">${author.bio}</p>` : ''}
                                ${author.email ? `<p style="color: #888; margin-bottom: 10px;"><i class="far fa-envelope"></i> ${author.email}</p>` : ''}
                                <div class="author-social" style="display: flex; gap: 15px; margin-top: 15px;">
                                    ${author.facebook_url ? `<a href="${author.facebook_url}" target="_blank" style="color: #1877f2;"><i class="fab fa-facebook-f"></i></a>` : ''}
                                    ${author.twitter_url ? `<a href="${author.twitter_url}" target="_blank" style="color: #1da1f2;"><i class="fab fa-twitter"></i></a>` : ''}
                                    ${author.instagram_url ? `<a href="${author.instagram_url}" target="_blank" style="color: #e4405f;"><i class="fab fa-instagram"></i></a>` : ''}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('author-profile').innerHTML = profileHTML;
                
                // Render stats
                const statsHTML = `
                    <div style="padding: 20px; background: #f7f7f9; border-radius: 8px;">
                        <div style="margin-bottom: 15px;">
                            <div style="font-size: 14px; color: #666;">Total Articles</div>
                            <div style="font-size: 24px; font-weight: bold; color: #333;">${author.statistics?.totalArticles || 0}</div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div style="font-size: 14px; color: #666;">Total Views</div>
                            <div style="font-size: 24px; font-weight: bold; color: #333;">${author.statistics?.totalViews || 0}</div>
                        </div>
                        <div>
                            <div style="font-size: 14px; color: #666;">Average Views</div>
                            <div style="font-size: 24px; font-weight: bold; color: #333;">${author.statistics?.averageViews || 0}</div>
                        </div>
                    </div>
                `;
                
                document.getElementById('author-stats').innerHTML = statsHTML;
                
                // Render articles
                if (author.articles && author.articles.length > 0) {
                    const articlesHTML = `
                        <h2 style="font-size: 24px; font-weight: bold; margin-bottom: 20px;">Articles by ${author.name}</h2>
                        <div class="list-post-wrap">
                            ${author.articles.map(article => `
                                <div class="list-post fl-wrap" style="margin-bottom: 30px; padding: 20px; background: white; border-radius: 12px;">
                                    ${article.featured_image ? `
                                        <div class="list-post-media" style="margin-bottom: 15px;">
                                            <a href="article.html?slug=${article.slug}">
                                                <img src="${article.featured_image}" alt="${article.title}" style="width: 100%; border-radius: 8px;">
                                            </a>
                                        </div>
                                    ` : ''}
                                    <div class="list-post-content">
                                        ${article.categories?.name ? `<a class="post-category-marker" href="index.html?category=${article.categories.slug}">${article.categories.name}</a>` : ''}
                                        <h3><a href="article.html?slug=${article.slug}">${article.title}</a></h3>
                                        ${article.excerpt ? `<p>${article.excerpt}</p>` : ''}
                                        <div style="display: flex; gap: 20px; margin-top: 15px; color: #888; font-size: 14px;">
                                            <span><i class="far fa-clock"></i> ${new Date(article.published_at).toLocaleDateString()}</span>
                                            <span><i class="fal fa-eye"></i> ${article.view_count || 0}</span>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    
                    document.getElementById('author-articles').innerHTML = articlesHTML;
                } else {
                    document.getElementById('author-articles').innerHTML = '<p>No articles found for this author.</p>';
                }
                
                document.title = `${author.name} - Author Profile - Blog`;
                document.querySelector('.ajax-loader').style.display = 'none';
                
            } catch (error) {
                console.error('Error loading author profile:', error);
                document.getElementById('author-profile').innerHTML = '<p>Error loading author profile</p>';
                document.querySelector('.ajax-loader').style.display = 'none';
            }
        }
        
        // Load on page load
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadAuthorProfile);
        } else {
            loadAuthorProfile();
        }
    </script>
</body>
</html>

